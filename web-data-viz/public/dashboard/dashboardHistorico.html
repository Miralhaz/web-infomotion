<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Histórico - InfoMotion</title>
  <link rel="stylesheet" href="../css/dashboard-historico.css">
  <link rel="icon" href="../assets/icon/Infomotion - lupa_branca.svg">
</head>

<body>
  <section class="header">
    <div class="header-left">
      <div class="parte-cima">
        <div class="icone ativo">
          <a href="perfil.html" class="descricao-icone">
            <img src="../assets/imgs-dashboard/perfil.png" alt="">
            Perfil </a>
        </div>
        <div id="usuario-header" class="icone">
          <a href="tela-usuarios.html" class="descricao-icone">
            <img src="../assets/imgs-dashboard/mdi_users.png" alt="">
            Usuários
          </a>
        </div>
        <div class="icone">
          <a href="tela-servidores.html" class="descricao-icone">
            <img src="../assets/imgs-dashboard/teenyicons_servers-solid.png" alt="">
            Servidores
          </a>
        </div>
        <div class="icone container-submenu">
          <a href="dashboardHistorico.html" class="descricao-icone">
            <img src="../assets/imgs-dashboard/fluent-mdl2_b-i-dashboard.png" alt="">
            Dashboard
            <p style="margin-left: 10px; font-size: 12px;">▶</p>
          </a>
          <div class="submenu">
            <a href="dashboardHistorico.html">Histórico</a>
            <a href="dashboardDisco.html">Disco dos Servidores</a>
            <a href="dashboardRegiao.html">Região</a>
          </div>
        </div>
      </div>

      <div class="parte-baixo">
        <div class="icone">
          <a href="https://sentinela-grupo-3.atlassian.net/servicedesk/customer/portal/35" class="descricao-icone">
            <img src="../assets/imgs-dashboard/fluent_person-suport-32-light.png" alt="">
            Suporte
          </a>
        </div>
        <div class="icone">
          <a href="../index.html" class="descricao-icone">
            <img src="../assets/imgs-dashboard/uil_exit.png" alt="">
            Sair
          </a>
        </div>
      </div>
    </div>
  </section>

  <div class="container dashboard_historico">
    <div class="div-selects">
      Tempo de captura:
      <select name="servidores" id="selectTempo" onchange="refresh(this.value)">
        <option value="" disabled>Selecione o tempo de medição</option>
        <option value="1">1 Dia</option>
        <option value="7">7 Dias</option>
        <option value="30">30 Dias</option>
      </select>

      Tipo de dashboard:
      <div class="nome_dash">
        Dashboard Histórico
      </div>
    </div>

    <div class="div-table-grafico">
      <div class="tabela_alerta_servidores">
        <div class="nome_tabela" id="nome_tabela">
          Relatório de alertas(X Tempo)
        </div>
        <table class="table_alerta_servidores">
          <thead>
            <tr>
              <th scope="col" onclick="ordenarPor('nome')" id="table_alerta_nome">Nome do servidor<img
                  src="../assets/icon/arrow_drop_down.svg" alt="drop_down"></th>
              <th scope="col" onclick="ordenarPor('cpu')" id="table_alerta_cpu">CPU<img
                  src="../assets/icon/arrow_drop_down.svg" alt="drop_down"></th>
              <th scope="col" onclick="ordenarPor('ram')" id="table_alerta_ram">RAM<img
                  src="../assets/icon/arrow_drop_down.svg" alt="drop_down"></th>
              <th scope="col" onclick="ordenarPor('disco')" id="table_alerta_disco">Disco<img
                  src="../assets/icon/arrow_drop_down.svg" alt="drop_down"></th>
              <th scope="col" onclick="ordenarPor('rede')" id="table_alerta_rede">Rede<img
                  src="../assets/icon/arrow_drop_down.svg" alt="drop_down"></th>
              <th scope="col" onclick="ordenarPor('total')" id="table_alerta_total">Total de alertas<img
                  src="../assets/icon/arrow_drop_down.svg" alt="drop_down"></th>
            </tr>
          </thead>
          <tbody id="bodyTabelaAlerta">
          </tbody>
        </table>
      </div>

      <div class="gráfico_chart">
        <div class="nome_gráfico" id="titulo">
          <a>Situação dos servidores</a>
        </div>
        <div class="div-pie-chart">
          <canvas id="pieChart" class="grafico_alertas_tempo"></canvas>
        </div>
      </div>
    </div>



    <div class="alerta_tempo_e_grafico_bolhas">

      <div class="gráfico_chart">
        <div class="nome_gráfico" id="nome_gráfico_linhas">
          <a>Situação dos servidores</a>
        </div>
        <div class="div-line-historico">
          <canvas id="lineChartHistorico" class="grafico_alertas_tempo" style="width: 100%;"></canvas>
        </div>
      </div>

      <div class="grafico_bubble">
        <div class="nome_gráfico" id="nome_gráfico">

          <div class="filtro-wrapper">
            <img src="../assets/imgs-dashboard/mynaui_filter_white.png" class="img-filtro" onclick="acionarFiltro()">

            <div class="filtro-menu" id="menu">
              <div class="opcoes-menu">
                <button onclick="carregarBolhas('cpu')">CPU</button>
                <button onclick="carregarBolhas('ram')">RAM</button>
                <button onclick="carregarBolhas('disco')">DISCO</button>
                <button onclick="carregarBolhas('temp_cpu')">TEMPERATURA DE CPU</button>
                <button onclick="carregarBolhas('temp_disco')">TEMPERATURA DE DISCO</button>
              </div>
            </div>
          </div>

          <a>Criticidade de componentes</a>
        </div>
        <div class="div-bubble-chart">
          <canvas id="bubbleChart" class="grafico_alertas_tempo"></canvas>
        </div>
      </div>
    </div>
  </div>
  </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.2.0/chartjs-plugin-datalabels.min.js"></script>
  <script src="../js/dashboard-historico.js"></script>
<script>
  const idUsuario = sessionStorage.getItem("ID_USUARIO")

  function refresh(x) {
    console.log('funcao refresh');

    localStorage.setItem("tempoSelecionado", x); // salva antes do reload
    location.reload()
  }

  function selecionarTempo() {
    const tempo = localStorage.getItem("tempoSelecionado");
    if (tempo) {
      document.getElementById("selectTempo").value = tempo;
    }
  }

  window.onload = async function () {
    selecionarTempo();
    await carregarDashboardDoS3();
  }
</script>
</html>